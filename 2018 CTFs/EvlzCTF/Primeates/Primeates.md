# **Primeates**

#### tag : crypto

-----------------------------------------------

#### Description

>>nc 35.200.197.38 8005

>>Europe: nc 35.231.8.67 8005

-----------------------------------------------

#### Solution

~~~

$ nc 35.200.197.38 8005
N is: 1483659040599803180465875747313487888755267972222069492447218852375145009089414954949436900286777768663826624034466040628427636845590840687367178740259350429928510371398292821983019234722021429112987528087543422680901688962649254502822661585755452018815891449149421962053158133900908076111001712841076289984980172645934381029021283997952281954862929155052680569028356963432716905810189565677209832513473653930443259204106549701621476868216781987138672677381900627
e is: 3
Cipher text is: 378298893916598086874607404131390876390122525545713488720877944575185623279732971227842503543642027704686114550783317830373635343922547497016866577366754346946921713513140776458160982993092663936827


1.Encryption
2.Decryption
3.Enter Password
>>>

~~~

In this prob, I find Ciphertext is not changed in every trying.

~~~

Cipher text is: 378298893916598086874607404131390876390122525545713488720877944575185623279732971227842503543642027704686114550783317830373635343922547497016866577366754346946921713513140776458160982993092663936827


1.Encryption
2.Decryption
3.Enter Password
>>>2
Enter ciphertext 378298893916598086874607404131390876390122525545713488720877944575185623279732971227842503543642027704686114550783317830373635343922547497016866577366754346946921713513140776458160982993092663936827
This is secret admin hash, not decrypting this lol

~~~

Well, prob block decrypting ciphertext given.

I want to gather running result to analyse enc, dec function.

So I make simple code to gather info.

~~~

from pwn import *

r = remote('35.200.197.38', 8005)

def enc(dec):
	r.recvuntil('>>>')
	r.sendline('1')
	r.recvuntil('number ')
	r.sendline(str(dec))
	return r.recvline()[20:-1]

def dec(enc):
	r.recvuntil('>>>')
	r.sendline('2')
	r.recvuntil('ciphertext ')
	r.sendline(str(enc))
	return r.recvline()[19:-1]

def main():
	n = int(r.recvline()[6:-1])
	e = int(r.recvline()[6:-1])
	c = int(r.recvline()[16:-1])

	for i in range(0, 10):
		print 'enc : ', i, enc(i)
		print 'dec : ', i, dec(i)

main()

~~~

~~~

$ python ./Primeates.py
[+] Opening connection to 35.200.197.38 on port 8005: Done
enc :  0 0
dec :  0 0
enc :  1 1
dec :  1 1
enc :  2 8
dec :  2 1269155495458647892254877212796672442333074363332458267428044124535536204581296352462420829819271523060559659367554375372001225083277895276940319547419742360596496788536590711125501144031593576571297000500654001642649340698090355464697480727197072836264810411091970472418414780232630457669067425059025946488327675244158137598447274369853435527832640581183984100560388142766268043520655361627663669744372432024308662358479777263185806509528595158773092112057385941
enc :  3 27
dec :  3 1598550477463002641734639105336620046996803746761057450978026915669555898182435732717025606834805996882220627797875559954811402598989460753456737500874143422029761477391789012906416487424904111565695112555772320421608119550828759338420148802989804282355167039683276573226858380158249391848748601707536430077614412255903116395942423197930723510137466870505382138923245629139550097001853542446531590515460412756819279012161684497315267974356029313387943792947127748
enc :  4 64
dec :  4 974951850039075214870363890015664595734611711365136269643797391764647763016475337036218924961738812423611573901857269457020515880972811410929766158427867225816761533236413355015836716268675189921723854668239014954908854136061670333530425820746318095231528294106277193354338738793286265974865684705969217142446860812002683681580965865876072264845847729207482477555186666898646836157115923158927943656755526170216135162544297983757179353617243124138542974184911594
enc :  5 125
dec :  5 1388129466166294821249541827166166475315271787514909487044822611313448704000051869880006453926187292567063986107594381916761561587250720573020277993686429238668978118462278509828255162123120819761709640810499579582873439573568112028868595083723982225516160397732752371725319689398133865226155881623713395552810151710090026885735646781401645982100733283897857108121444244600027040865982005272117139883053295904236622181353874527618376474548065913499639480168038274
enc :  6 216
dec :  6 1424522684960006495857055869556208115239455871579540800336025640984928058141425748287781416479791643161335502722241498799490786905167584282935626775648205117259376416637579724792891368850632937892151702767562878721800911614352891880383657900294659844625130146786086749792374642191911720062449461041624744590423220680827055988534165990512610017557237277629367331376880119890408391995875211851583766431244492667916461590288208066881422824435175875229282283998482563
enc :  7 343
dec :  7 141284774068043572911195183407601112892040397238387441692813161527474249891688789818656217252341687974683235550869380613002671442092287152432164518811129761430792354731526783267385688478857317334642958831856879126521393242105382448515067420237523134641037235241278070017162173101027565205134904807807762293409541231191802156960730580622880762120629579877011743655956166655574084662593598258349588509857566480295193812550455415083304115130822130828305255165433358
enc :  8 512
dec :  8 2
enc :  9 729
dec :  9 270264038715098647043381995438698633622230121156344373575871659761933393966059063948934532160926054353288870798924764489187841996582235278722646054394449285572839255010731497977397142656506119928130092765752250952995092643433459725012991645054817605261157076634687084864019384477912593094674812068499055528147153758624891934541962520057108618595461546092051601988093017769688152958023523571504137288828822309650648143288066089338139206364737318394338435595053226
[*] Closed connection to 35.200.197.38 port 8005

~~~

Hum, I make decision that dec function is unpredictable. But enc function is:

~~~

enc(x) = ( x ^ e ) mod n = ( x ^ 3 ) mod n

~~~

This mean if ciphertext is lower than n, it must be cipher = plain^3.

http://www.factordb.com/index.php?query=378298893916598086874607404131390876390122525545713488720877944575185623279732971227842503543642027704686114550783317830373635343922547497016866577366754346946921713513140776458160982993092663936827

I use this database to find plain(x).

~~~

cipher = (7232332049...03<66>)^3 = 723233204932732303232804824329562012733423232323723208322321218403^3

~~~

x is 723233204932732303232804824329562012733423232323723208322321218403.

~~~

Enter the password 723233204932732303232804824329562012733423232323723208322321218403
evlz{my_very_oracle_attack}ctf

~~~

**evlz{my_very_oracle_attack}ctf**
